///// Survey Constructs and Subconstruct - Percent Most Positive (down and across method)
  // Note: to display at the school and network level we need to create the virtual AGGR table with School Name as a dimension
  //  This means that for each school we'll get an average for each question.
  //  This will display correctly if we analyze at the school level, because the average is just that school's questions
  //  This will not display correctly at the district level, because it will be the average of all schools x all questions

  //// Student Climate subconstructs (Belonging, Bullying, Safety/Building Condition)
    let vCount_Student_Climate_Belonging_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Belonging_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Belonging_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Belonging_Current), '&chr(36)&'(vPercMP_Student_Climate_Belonging_Current), Null())';
    let vAvgScore_Student_Climate_Belonging_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Belonging_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Belonging_Current), '&chr(36)&'(vAvgScore_Student_Climate_Belonging_Current), Null())';
    
    let vCount_Student_Climate_Bullying_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Bullying_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Bullying_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Bullying_Current), '&chr(36)&'(vPercMP_Student_Climate_Bullying_Current), Null())';
    let vAvgScore_Student_Climate_Bullying_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Bullying_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Bullying_Current), '&chr(36)&'(vAvgScore_Student_Climate_Bullying_Current), Null())';
    
    let vCount_Student_Climate_Safety_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Safety_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Safety_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Safety_Current), '&chr(36)&'(vPercMP_Student_Climate_Safety_Current), Null())';
    let vAvgScore_Student_Climate_Safety_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Safety_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Safety_Current), '&chr(36)&'(vAvgScore_Student_Climate_Safety_Current), Null())';
    
     // divide by 3 subconstructs
    let vCount_Student_Climate_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Current = '('&chr(36)&'(vPercMP_Student_Climate_Belonging_Current) + '&chr(36)&'(vPercMP_Student_Climate_Bullying_Current) + '&chr(36)&'(vPercMP_Student_Climate_Safety_Current)) / 3';
    let vmmPercMP_Student_Climate_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Current), '&chr(36)&'(vPercMP_Student_Climate_Current), Null())';
    let vAvgScore_Student_Climate_Current = '('&chr(36)&'(vAvgScore_Student_Climate_Belonging_Current) + '&chr(36)&'(vAvgScore_Student_Climate_Bullying_Current) + '&chr(36)&'(vAvgScore_Student_Climate_Safety_Current)) / 3';
    let vmmAvgScore_Student_Climate_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Current), '&chr(36)&'(vAvgScore_Student_Climate_Current), Null())';
    
     // previous year
    let vCount_Student_Climate_Belonging_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Belonging_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Belonging_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Belonging_Previous), '&chr(36)&'(vPercMP_Student_Climate_Belonging_Previous), Null())';
    let vAvgScore_Student_Climate_Belonging_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Belonging"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Belonging_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Belonging_Previous), '&chr(36)&'(vAvgScore_Student_Climate_Belonging_Previous), Null())';
    
    let vCount_Student_Climate_Bullying_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Bullying_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Bullying_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Bullying_Previous), '&chr(36)&'(vPercMP_Student_Climate_Bullying_Previous), Null())';
    let vAvgScore_Student_Climate_Bullying_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Bullying_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Bullying_Previous), '&chr(36)&'(vAvgScore_Student_Climate_Bullying_Previous), Null())';
    
    let vCount_Student_Climate_Safety_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Safety_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Climate_Safety_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Safety_Previous), '&chr(36)&'(vPercMP_Student_Climate_Safety_Previous), Null())';
    let vAvgScore_Student_Climate_Safety_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Climate_Safety_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Safety_Previous), '&chr(36)&'(vAvgScore_Student_Climate_Safety_Previous), Null())';
    
     // divide by 3 subconstructs
    let vCount_Student_Climate_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Climate_Previous = '('&chr(36)&'(vPercMP_Student_Climate_Belonging_Previous) + '&chr(36)&'(vPercMP_Student_Climate_Bullying_Previous) + '&chr(36)&'(vPercMP_Student_Climate_Safety_Previous)) / 3';
    let vmmPercMP_Student_Climate_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Previous), '&chr(36)&'(vPercMP_Student_Climate_Previous), Null())';
    let vAvgScore_Student_Climate_Previous = '('&chr(36)&'(vAvgScore_Student_Climate_Belonging_Previous) + '&chr(36)&'(vAvgScore_Student_Climate_Bullying_Previous) + '&chr(36)&'(vAvgScore_Student_Climate_Safety_Previous)) / 3';
    let vmmAvgScore_Student_Climate_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Climate_Previous), '&chr(36)&'(vAvgScore_Student_Climate_Previous), Null())';
  
  //// Student Instruction (no subconstructs)
    let vCount_Student_Instruction_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Instruction_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Instruction_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Instruction_Current), '&chr(36)&'(vPercMP_Student_Instruction_Current), Null())';
    let vAvgScore_Student_Instruction_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Instruction_Current = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Instruction_Current), '&chr(36)&'(vAvgScore_Student_Instruction_Current), Null())';
    
    let vCount_Student_Instruction_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Student_Instruction_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Student_Instruction_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Instruction_Previous), '&chr(36)&'(vPercMP_Student_Instruction_Previous), Null())';
    let vAvgScore_Student_Instruction_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Student"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Student_Instruction_Previous = 'IF('&chr(36)&'(vMinStudents) <= '&chr(36)&'(vCount_Student_Instruction_Previous), '&chr(36)&'(vAvgScore_Student_Instruction_Previous), Null())';
   
  //// Parent Climate subconstructs (Attendance Challenges, Bullying, Safety/Building Condition)
    let vCount_Parent_Climate_Attendance_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Attendance_Current), '&chr(36)&'(vPercMP_Parent_Climate_Attendance_Current), Null())';
    let vAvgScore_Parent_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Attendance_Current), '&chr(36)&'(vAvgScore_Parent_Climate_Attendance_Current), Null())';
    
    let vCount_Parent_Climate_Bullying_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Bullying_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Bullying_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Bullying_Current), '&chr(36)&'(vPercMP_Parent_Climate_Bullying_Current), Null())';
    let vAvgScore_Parent_Climate_Bullying_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Bullying_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Bullying_Current), '&chr(36)&'(vAvgScore_Parent_Climate_Bullying_Current), Null())';
    
    let vCount_Parent_Climate_Safety_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Safety_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Safety_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Safety_Current), '&chr(36)&'(vPercMP_Parent_Climate_Safety_Current), Null())';
    let vAvgScore_Parent_Climate_Safety_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Safety_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Safety_Current), '&chr(36)&'(vAvgScore_Parent_Climate_Safety_Current), Null())';
    
    // divide by 3 constructs
    let vCount_Parent_Climate_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Current = '('&chr(36)&'(vPercMP_Parent_Climate_Attendance_Current) + '&chr(36)&'(vPercMP_Parent_Climate_Bullying_Current) + '&chr(36)&'(vPercMP_Parent_Climate_Safety_Current)) / 3';
    let vmmPercMP_Parent_Climate_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Current), '&chr(36)&'(vPercMP_Parent_Climate_Current), Null())';
    let vAvgScore_Parent_Climate_Current = '('&chr(36)&'(vAvgScore_Parent_Climate_Attendance_Current) + '&chr(36)&'(vAvgScore_Parent_Climate_Bullying_Current) + '&chr(36)&'(vAvgScore_Parent_Climate_Safety_Current)) / 3';
    let vmmAvgScore_Parent_Climate_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Current), '&chr(36)&'(vAvgScore_Parent_Climate_Current), Null())';
   
     // previous year
    let vCount_Parent_Climate_Attendance_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Attendance_Previous), '&chr(36)&'(vPercMP_Parent_Climate_Attendance_Previous), Null())';
    let vAvgScore_Parent_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance Challenges"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Attendance_Previous), '&chr(36)&'(vAvgScore_Parent_Climate_Attendance_Previous), Null())';
    
    let vCount_Parent_Climate_Bullying_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Bullying_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Bullying_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Bullying_Previous), '&chr(36)&'(vPercMP_Parent_Climate_Bullying_Previous), Null())';
    let vAvgScore_Parent_Climate_Bullying_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Bullying"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Bullying_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Bullying_Previous), '&chr(36)&'(vAvgScore_Parent_Climate_Bullying_Previous), Null())';
    
    let vCount_Parent_Climate_Safety_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Safety_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Climate_Safety_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Safety_Previous), '&chr(36)&'(vPercMP_Parent_Climate_Safety_Previous), Null())';
    let vAvgScore_Parent_Climate_Safety_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Safety/Building Condition"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Climate_Safety_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Safety_Previous), '&chr(36)&'(vAvgScore_Parent_Climate_Safety_Previous), Null())';
    
    // divide by 3 subconstructs
    let vCount_Parent_Climate_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Climate_Previous = '('&chr(36)&'(vPercMP_Parent_Climate_Attendance_Previous) + '&chr(36)&'(vPercMP_Parent_Climate_Bullying_Previous) + '&chr(36)&'(vPercMP_Parent_Climate_Safety_Previous)) / 3';
    let vmmPercMP_Parent_Climate_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Previous), '&chr(36)&'(vPercMP_Parent_Climate_Previous), Null())';
    let vAvgScore_Parent_Climate_Previous = '('&chr(36)&'(vAvgScore_Parent_Climate_Attendance_Previous) + '&chr(36)&'(vAvgScore_Parent_Climate_Bullying_Previous) + '&chr(36)&'(vAvgScore_Parent_Climate_Safety_Previous)) / 3';
    let vmmAvgScore_Parent_Climate_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Climate_Previous), '&chr(36)&'(vAvgScore_Parent_Climate_Previous), Null())';
  
  //// Parent Instruction (Evaluation of Extracurricular, Evaluation of Teaching & Learning)
    let vCount_Parent_Instruction_Extracurricular_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Extracurricular_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Instruction_Extracurricular_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Extracurricular_Current), '&chr(36)&'(vPercMP_Parent_Instruction_Extracurricular_Current), Null())';
    let vAvgScore_Parent_Instruction_Extracurricular_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Instruction_Extracurricular_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Extracurricular_Current), '&chr(36)&'(vAvgScore_Parent_Instruction_Extracurricular_Current), Null())';
    
    let vCount_Parent_Instruction_Teaching_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Teaching_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Instruction_Teaching_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Teaching_Current), '&chr(36)&'(vPercMP_Parent_Instruction_Teaching_Current), Null())';
    let vAvgScore_Parent_Instruction_Teaching_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Instruction_Teaching_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Teaching_Current), '&chr(36)&'(vAvgScore_Parent_Instruction_Teaching_Current), Null())';
    
    // divide by 2 subconstructs 
    let vCount_Parent_Instruction_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Current = '('&chr(36)&'(vPercMP_Parent_Instruction_Extracurricular_Current) + '&chr(36)&'(vPercMP_Parent_Instruction_Teaching_Current)) / 2';
    let vmmPercMP_Parent_Instruction_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Current), '&chr(36)&'(vPercMP_Parent_Instruction_Current), Null())';
    let vAvgScore_Parent_Instruction_Current = '('&chr(36)&'(vAvgScore_Parent_Instruction_Extracurricular_Current) + '&chr(36)&'(vAvgScore_Parent_Instruction_Teaching_Current)) / 2';
    let vmmAvgScore_Parent_Instruction_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Current), '&chr(36)&'(vAvgScore_Parent_Instruction_Current), Null())';
    
     // previous year
    let vCount_Parent_Instruction_Extracurricular_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Extracurricular_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Instruction_Extracurricular_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Extracurricular_Previous), '&chr(36)&'(vPercMP_Parent_Instruction_Extracurricular_Previous), Null())';
    let vAvgScore_Parent_Instruction_Extracurricular_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Extracurricular"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Instruction_Extracurricular_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Extracurricular_Previous), '&chr(36)&'(vAvgScore_Parent_Instruction_Extracurricular_Previous), Null())';
    
    let vCount_Parent_Instruction_Teaching_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Teaching_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_Instruction_Teaching_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Teaching_Previous), '&chr(36)&'(vPercMP_Parent_Instruction_Teaching_Previous), Null())';
    let vAvgScore_Parent_Instruction_Teaching_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Evaluation of Teaching & Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_Instruction_Teaching_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Teaching_Previous), '&chr(36)&'(vAvgScore_Parent_Instruction_Teaching_Previous), Null())';
    
    // divide by 2 subconstructs 
    let vCount_Parent_Instruction_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_Instruction_Previous = '('&chr(36)&'(vPercMP_Parent_Instruction_Extracurricular_Previous) + '&chr(36)&'(vPercMP_Parent_Instruction_Teaching_Previous)) / 2';
    let vmmPercMP_Parent_Instruction_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Previous), '&chr(36)&'(vPercMP_Parent_Instruction_Previous), Null())';
    let vAvgScore_Parent_Instruction_Previous = '('&chr(36)&'(vAvgScore_Parent_Instruction_Extracurricular_Previous) + '&chr(36)&'(vAvgScore_Parent_Instruction_Teaching_Previous)) / 2';
    let vmmAvgScore_Parent_Instruction_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_Instruction_Previous), '&chr(36)&'(vAvgScore_Parent_Instruction_Previous), Null())';
  
   //// Parent Parent/Guardian-Community Ties (Communication Frequency, Communication Quality, Community Services, Parent/Guardian-School Networks, Parent/Guardian Involvement, School Relationship)
    let vCount_Parent_CommunityTies_CommunicationFrequency_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunicationFrequency_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunicationFrequency_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationFrequency_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationFrequency_Current), Null())';
    let vAvgScore_Parent_CommunityTies_CommunicationFrequency_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunicationFrequency_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationFrequency_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationFrequency_Current), Null())';
   
    let vCount_Parent_CommunityTies_CommunicationQuality_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunicationQuality_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunicationQuality_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationQuality_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationQuality_Current), Null())';
    let vAvgScore_Parent_CommunityTies_CommunicationQuality_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunicationQuality_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationQuality_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationQuality_Current), Null())';
    
    let vCount_Parent_CommunityTies_CommunityServices_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunityServices_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunityServices_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunityServices_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunityServices_Current), Null())';
    let vAvgScore_Parent_CommunityTies_CommunityServices_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunityServices_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunityServices_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunityServices_Current), Null())';
   
    let vCount_Parent_CommunityTies_SchoolNetworks_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_SchoolNetworks_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_SchoolNetworks_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolNetworks_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolNetworks_Current), Null())';
    let vAvgScore_Parent_CommunityTies_SchoolNetworks_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_SchoolNetworks_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolNetworks_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolNetworks_Current), Null())';
   
    let vCount_Parent_CommunityTies_Involvement_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_Involvement_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_Involvement_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Involvement_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_Involvement_Current), Null())';
    let vAvgScore_Parent_CommunityTies_Involvement_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_Involvement_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Involvement_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_Involvement_Current), Null())';
   
    let vCount_Parent_CommunityTies_SchoolRelationship_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_SchoolRelationship_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_SchoolRelationship_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolRelationship_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolRelationship_Current), Null())';
    let vAvgScore_Parent_CommunityTies_SchoolRelationship_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_SchoolRelationship_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolRelationship_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolRelationship_Current), Null())';
    
    // divide by 6 subconstructs 
    let vCount_Parent_CommunityTies_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Relationships"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_Current = '('&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationFrequency_Current) + '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationQuality_Current) + '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunityServices_Current) + '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolNetworks_Current) + '&chr(36)&'(vPercMP_Parent_CommunityTies_Involvement_Current) + '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolRelationship_Current)) / 6';
    let vmmPercMP_Parent_CommunityTies_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Current), '&chr(36)&'(vPercMP_Parent_CommunityTies_Current), Null())';
    let vAvgScore_Parent_CommunityTies_Current = '('&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationFrequency_Current) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationQuality_Current) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunityServices_Current) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolNetworks_Current) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_Involvement_Current) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolRelationship_Current)) / 6';
    let vmmAvgScore_Parent_CommunityTies_Current = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Current), '&chr(36)&'(vAvgScore_Parent_CommunityTies_Current), Null())';
  
     // previous year
    let vCount_Parent_CommunityTies_CommunicationFrequency_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunicationFrequency_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunicationFrequency_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationFrequency_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationFrequency_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_CommunicationFrequency_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Frequency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunicationFrequency_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationFrequency_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationFrequency_Previous), Null())';
   
    let vCount_Parent_CommunityTies_CommunicationQuality_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunicationQuality_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunicationQuality_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationQuality_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationQuality_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_CommunicationQuality_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Communication Quality"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunicationQuality_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunicationQuality_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationQuality_Previous), Null())';
    
    let vCount_Parent_CommunityTies_CommunityServices_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_CommunityServices_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_CommunityServices_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunityServices_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunityServices_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_CommunityServices_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Community Services"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_CommunityServices_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_CommunityServices_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunityServices_Previous), Null())';
   
    let vCount_Parent_CommunityTies_SchoolNetworks_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_SchoolNetworks_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_SchoolNetworks_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolNetworks_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolNetworks_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_SchoolNetworks_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian-School Networks"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_SchoolNetworks_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolNetworks_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolNetworks_Previous), Null())';
   
    let vCount_Parent_CommunityTies_Involvement_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_Involvement_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_Involvement_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Involvement_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_Involvement_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_Involvement_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"Parent/Guardian Involvement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_Involvement_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Involvement_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_Involvement_Previous), Null())';
   
    let vCount_Parent_CommunityTies_SchoolRelationship_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_SchoolRelationship_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Parent_CommunityTies_SchoolRelationship_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolRelationship_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolRelationship_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_SchoolRelationship_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"Parent/Guardian-Community Ties"}, subConstructForDisplay={"School Relationship"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Parent_CommunityTies_SchoolRelationship_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_SchoolRelationship_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolRelationship_Previous), Null())';
    
    // divide by 6 subconstructs 
    let vCount_Parent_CommunityTies_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Parent"}, questionconstruct={"School Relationships"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Parent_CommunityTies_Previous = '('&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationFrequency_Previous) + '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunicationQuality_Previous) + '&chr(36)&'(vPercMP_Parent_CommunityTies_CommunityServices_Previous) + '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolNetworks_Previous) + '&chr(36)&'(vPercMP_Parent_CommunityTies_Involvement_Previous) + '&chr(36)&'(vPercMP_Parent_CommunityTies_SchoolRelationship_Previous)) / 6';
    let vmmPercMP_Parent_CommunityTies_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Previous), '&chr(36)&'(vPercMP_Parent_CommunityTies_Previous), Null())';
    let vAvgScore_Parent_CommunityTies_Previous = '('&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationFrequency_Previous) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunicationQuality_Previous) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_CommunityServices_Previous) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolNetworks_Previous) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_Involvement_Previous) + '&chr(36)&'(vAvgScore_Parent_CommunityTies_SchoolRelationship_Previous)) / 6';
    let vmmAvgScore_Parent_CommunityTies_Previous = 'IF('&chr(36)&'(vMinParents) <= '&chr(36)&'(vCount_Parent_CommunityTies_Previous), '&chr(36)&'(vAvgScore_Parent_CommunityTies_Previous), Null())';
  
  //// Teacher Climate 4 subconstructs (Attendance, Classroom Level Challenges to Student Learning, External Challenges to Student Learning, School Level Challenges to Student Learning)
    let vCount_Teacher_Climate_Attendance_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Attendance_Current), '&chr(36)&'(vPercMP_Teacher_Climate_Attendance_Current), Null())';
    let vAvgScore_Teacher_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Attendance_Current), '&chr(36)&'(vAvgScore_Teacher_Climate_Attendance_Current), Null())';

    let vCount_Teacher_Climate_ClassroomChallenges_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_ClassroomChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_ClassroomChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ClassroomChallenges_Current), '&chr(36)&'(vPercMP_Teacher_Climate_ClassroomChallenges_Current), Null())';
    let vAvgScore_Teacher_Climate_ClassroomChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_ClassroomChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ClassroomChallenges_Current), '&chr(36)&'(vAvgScore_Teacher_Climate_ClassroomChallenges_Current), Null())';

    let vCount_Teacher_Climate_ExternalChallenges_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_ExternalChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_ExternalChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ExternalChallenges_Current), '&chr(36)&'(vPercMP_Teacher_Climate_ExternalChallenges_Current), Null())';
    let vAvgScore_Teacher_Climate_ExternalChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_ExternalChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ExternalChallenges_Current), '&chr(36)&'(vAvgScore_Teacher_Climate_ExternalChallenges_Current), Null())';

    let vCount_Teacher_Climate_SchoolChallenges_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_SchoolChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_SchoolChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_SchoolChallenges_Current), '&chr(36)&'(vPercMP_Teacher_Climate_SchoolChallenges_Current), Null())';
    let vAvgScore_Teacher_Climate_SchoolChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_SchoolChallenges_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_SchoolChallenges_Current), '&chr(36)&'(vAvgScore_Teacher_Climate_SchoolChallenges_Current), Null())';

    // divide by 4 subconstructs 
    let vCount_Teacher_Climate_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_Current = '('&chr(36)&'(vPercMP_Teacher_Climate_Attendance_Current) + '&chr(36)&'(vPercMP_Teacher_Climate_ClassroomChallenges_Current) + '&chr(36)&'(vPercMP_Teacher_Climate_ExternalChallenges_Current) + '&chr(36)&'(vPercMP_Teacher_Climate_SchoolChallenges_Current)) / 4';
    let vmmPercMP_Teacher_Climate_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Current), '&chr(36)&'(vPercMP_Teacher_Climate_Current), Null())';
    let vAvgScore_Teacher_Climate_Current = '('&chr(36)&'(vAvgScore_Teacher_Climate_Attendance_Current) + '&chr(36)&'(vAvgScore_Teacher_Climate_ClassroomChallenges_Current) + '&chr(36)&'(vAvgScore_Teacher_Climate_ExternalChallenges_Current) + '&chr(36)&'(vAvgScore_Teacher_Climate_SchoolChallenges_Current)) / 4';
    let vmmAvgScore_Teacher_Climate_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Current), '&chr(36)&'(vAvgScore_Teacher_Climate_Current), Null())';
    
    // previous year
    let vCount_Teacher_Climate_Attendance_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Attendance_Previous), '&chr(36)&'(vPercMP_Teacher_Climate_Attendance_Previous), Null())';
    let vAvgScore_Teacher_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Attendance_Previous), '&chr(36)&'(vAvgScore_Teacher_Climate_Attendance_Previous), Null())';

    let vCount_Teacher_Climate_ClassroomChallenges_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_ClassroomChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_ClassroomChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ClassroomChallenges_Previous), '&chr(36)&'(vPercMP_Teacher_Climate_ClassroomChallenges_Previous), Null())';
    let vAvgScore_Teacher_Climate_ClassroomChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Classroom Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_ClassroomChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ClassroomChallenges_Previous), '&chr(36)&'(vAvgScore_Teacher_Climate_ClassroomChallenges_Previous), Null())';

    let vCount_Teacher_Climate_ExternalChallenges_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_ExternalChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_ExternalChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ExternalChallenges_Previous), '&chr(36)&'(vPercMP_Teacher_Climate_ExternalChallenges_Previous), Null())';
    let vAvgScore_Teacher_Climate_ExternalChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_ExternalChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_ExternalChallenges_Previous), '&chr(36)&'(vAvgScore_Teacher_Climate_ExternalChallenges_Previous), Null())';

    let vCount_Teacher_Climate_SchoolChallenges_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_SchoolChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Climate_SchoolChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_SchoolChallenges_Previous), '&chr(36)&'(vPercMP_Teacher_Climate_SchoolChallenges_Previous), Null())';
    let vAvgScore_Teacher_Climate_SchoolChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Climate_SchoolChallenges_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_SchoolChallenges_Previous), '&chr(36)&'(vAvgScore_Teacher_Climate_SchoolChallenges_Previous), Null())';

    // divide by 4 subconstructs 
    let vCount_Teacher_Climate_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Climate_Previous = '('&chr(36)&'(vPercMP_Teacher_Climate_Attendance_Previous) + '&chr(36)&'(vPercMP_Teacher_Climate_ClassroomChallenges_Previous) + '&chr(36)&'(vPercMP_Teacher_Climate_ExternalChallenges_Previous) + '&chr(36)&'(vPercMP_Teacher_Climate_SchoolChallenges_Previous)) / 4';
    let vmmPercMP_Teacher_Climate_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Previous), '&chr(36)&'(vPercMP_Teacher_Climate_Previous), Null())';
    let vAvgScore_Teacher_Climate_Previous = '('&chr(36)&'(vAvgScore_Teacher_Climate_Attendance_Previous) + '&chr(36)&'(vAvgScore_Teacher_Climate_ClassroomChallenges_Previous) + '&chr(36)&'(vAvgScore_Teacher_Climate_ExternalChallenges_Previous) + '&chr(36)&'(vAvgScore_Teacher_Climate_SchoolChallenges_Previous)) / 4';
    let vmmAvgScore_Teacher_Climate_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Climate_Previous), '&chr(36)&'(vAvgScore_Teacher_Climate_Previous), Null())';
  
  //// Teacher Instruction 2 subconstructs (General Instructional Strategies, Student Engagement)
    let vCount_Teacher_Instruction_InstructionalStrategies_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_InstructionalStrategies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Instruction_InstructionalStrategies_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_InstructionalStrategies_Current), '&chr(36)&'(vPercMP_Teacher_Instruction_InstructionalStrategies_Current), Null())';
    let vAvgScore_Teacher_Instruction_InstructionalStrategies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Instruction_InstructionalStrategies_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_InstructionalStrategies_Current), '&chr(36)&'(vAvgScore_Teacher_Instruction_InstructionalStrategies_Current), Null())';

    let vCount_Teacher_Instruction_StudentEngagement_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_StudentEngagement_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Instruction_StudentEngagement_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_StudentEngagement_Current), '&chr(36)&'(vPercMP_Teacher_Instruction_StudentEngagement_Current), Null())';
    let vAvgScore_Teacher_Instruction_StudentEngagement_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Instruction_StudentEngagement_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_StudentEngagement_Current), '&chr(36)&'(vAvgScore_Teacher_Instruction_StudentEngagement_Current), Null())';

    // divide by 2 subconstructs 
    let vCount_Teacher_Instruction_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_Current = '('&chr(36)&'(vPercMP_Teacher_Instruction_InstructionalStrategies_Current) + '&chr(36)&'(vPercMP_Teacher_Instruction_StudentEngagement_Current)) / 2';
    let vmmPercMP_Teacher_Instruction_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_Current), '&chr(36)&'(vPercMP_Teacher_Instruction_Current), Null())';
    let vAvgScore_Teacher_Instruction_Current = '('&chr(36)&'(vAvgScore_Teacher_Instruction_InstructionalStrategies_Current) + '&chr(36)&'(vAvgScore_Teacher_Instruction_StudentEngagement_Current)) / 2';
    let vmmAvgScore_Teacher_Instruction_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_Current), '&chr(36)&'(vAvgScore_Teacher_Instruction_Current), Null())';
    
    // previous year
    let vCount_Teacher_Instruction_InstructionalStrategies_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_InstructionalStrategies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Instruction_InstructionalStrategies_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_InstructionalStrategies_Previous), '&chr(36)&'(vPercMP_Teacher_Instruction_InstructionalStrategies_Previous), Null())';
    let vAvgScore_Teacher_Instruction_InstructionalStrategies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"General Instructional Strategies"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Instruction_InstructionalStrategies_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_InstructionalStrategies_Previous), '&chr(36)&'(vAvgScore_Teacher_Instruction_InstructionalStrategies_Previous), Null())';

    let vCount_Teacher_Instruction_StudentEngagement_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_StudentEngagement_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_Instruction_StudentEngagement_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_StudentEngagement_Previous), '&chr(36)&'(vPercMP_Teacher_Instruction_StudentEngagement_Previous), Null())';
    let vAvgScore_Teacher_Instruction_StudentEngagement_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Student Engagement"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_Instruction_StudentEngagement_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_StudentEngagement_Previous), '&chr(36)&'(vAvgScore_Teacher_Instruction_StudentEngagement_Previous), Null())';

    // divide by 2 subconstructs 
    let vCount_Teacher_Instruction_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_Instruction_Previous = '('&chr(36)&'(vPercMP_Teacher_Instruction_InstructionalStrategies_Previous) + '&chr(36)&'(vPercMP_Teacher_Instruction_StudentEngagement_Previous)) / 2';
    let vmmPercMP_Teacher_Instruction_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_Previous), '&chr(36)&'(vPercMP_Teacher_Instruction_Previous), Null())';
    let vAvgScore_Teacher_Instruction_Previous = '('&chr(36)&'(vAvgScore_Teacher_Instruction_InstructionalStrategies_Previous) + '&chr(36)&'(vAvgScore_Teacher_Instruction_StudentEngagement_Previous)) / 2';
    let vmmAvgScore_Teacher_Instruction_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_Instruction_Previous), '&chr(36)&'(vAvgScore_Teacher_Instruction_Previous), Null())';
  
  //// Teacher Parent/Guardian-Community Ties 0 subconstructs 
    let vCount_Teacher_CommunityTies_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_CommunityTies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_CommunityTies_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_CommunityTies_Current), '&chr(36)&'(vPercMP_Teacher_CommunityTies_Current), Null())';
    let vAvgScore_Teacher_CommunityTies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_CommunityTies_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_CommunityTies_Current), '&chr(36)&'(vAvgScore_Teacher_CommunityTies_Current), Null())';

    // previous year
    let vCount_Teacher_CommunityTies_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_CommunityTies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_CommunityTies_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_CommunityTies_Previous), '&chr(36)&'(vPercMP_Teacher_CommunityTies_Previous), Null())';
    let vAvgScore_Teacher_CommunityTies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_CommunityTies_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_CommunityTies_Previous), '&chr(36)&'(vAvgScore_Teacher_CommunityTies_Previous), Null())';

  //// Teacher Professional Capacity 6 subconstructs (Innovation, Peer Collaboration, Peer Collaboration: Focus Area, Quality of Professional Development: Consistency, Quality of Professional Development: Content Focus and Duration, Quality of Professional Development: Delivery)
    let vCount_Teacher_ProfessionalCapacity_Innovation_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_Innovation_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_Innovation_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Innovation_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Innovation_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_Innovation_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_Innovation_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Innovation_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Innovation_Current), Null())';

    let vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Current), Null())';

    let vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDConsistency_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDConsistency_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDConsistency_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDConsistency_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Current), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDContent_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDContent_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDContent_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDContent_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDContent_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDContent_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDContent_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDContent_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDContent_Current), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDDelivery_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDDelivery_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDDelivery_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDDelivery_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Current), Null())';

    // divide by 6 subconstructs
    let vCount_Teacher_ProfessionalCapacity_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School ProfessionalCapacity"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_Current = '('&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Innovation_Current) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Current) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Current) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDContent_Current) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Current)) / 6';
    let vmmPercMP_Teacher_ProfessionalCapacity_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Current), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Current), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_Current = '('&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Innovation_Current) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Current) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Current) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Current) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDContent_Current) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Current)) / 64';
    let vmmAvgScore_Teacher_ProfessionalCapacity_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Current), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Current), Null())';
    
    // previous year
    let vCount_Teacher_ProfessionalCapacity_Innovation_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_Innovation_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_Innovation_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Innovation_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Innovation_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_Innovation_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Innovation"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_Innovation_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Innovation_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Innovation_Previous), Null())';

    let vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaboration_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Previous), Null())';

    let vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration: Focus Area"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDConsistency_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDConsistency_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDConsistency_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Consistency"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDConsistency_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Previous), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDContent_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDContent_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDContent_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDContent_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDContent_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDContent_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Content Focus and Duration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDContent_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDContent_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDContent_Previous), Null())';

    let vCount_Teacher_ProfessionalCapacity_PDDelivery_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_ProfessionalCapacity_PDDelivery_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDDelivery_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Quality of Professional Development: Delivery"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_PDDelivery_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Previous), Null())';

    // divide by 6 subconstructs
    let vCount_Teacher_ProfessionalCapacity_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School ProfessionalCapacity"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_ProfessionalCapacity_Previous = '('&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Innovation_Previous) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaboration_Previous) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDConsistency_Previous) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDContent_Previous) + '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_PDDelivery_Previous)) / 6';
    let vmmPercMP_Teacher_ProfessionalCapacity_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Previous), '&chr(36)&'(vPercMP_Teacher_ProfessionalCapacity_Previous), Null())';
    let vAvgScore_Teacher_ProfessionalCapacity_Previous = '('&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Innovation_Previous) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaboration_Previous) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PeerCollaborationFocus_Previous) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDConsistency_Previous) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDContent_Previous) + '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_PDDelivery_Previous)) / 6';
    let vmmAvgScore_Teacher_ProfessionalCapacity_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_ProfessionalCapacity_Previous), '&chr(36)&'(vAvgScore_Teacher_ProfessionalCapacity_Previous), Null())';
    
  //// Teacher School Leadership 3 subconstructs (Classroom Level Decision Making, Expectations & Feedback, Inclusive Leadership)
    let vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current), Null())';
    let vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current), Null())';

    let vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Current), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Current), Null())';
    let vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Current), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Current), Null())';

    let vCount_Teacher_SchoolLeadership_InclusiveLeadership_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_InclusiveLeadership_Current), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Current), Null())';
    let vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_InclusiveLeadership_Current), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Current), Null())';

    // divide by 3 subconstructs 
    let vCount_Teacher_SchoolLeadership_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_Current = '('&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current) + '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Current) + '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Current)) / 3';
    let vmmPercMP_Teacher_SchoolLeadership_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_Current), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_Current), Null())';
    let vAvgScore_Teacher_SchoolLeadership_Current = '('&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Current) + '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Current) + '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Current)) / 3';
    let vmmAvgScore_Teacher_SchoolLeadership_Current = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_Current), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_Current), Null())';
  
    // previous year
    let vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous), Null())';
    let vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Classroom Level Decision Making"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous), Null())';

    let vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Previous), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Previous), Null())';
    let vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Expectations & Feedback"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_ExpectationsFeedback_Previous), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Previous), Null())';

    let vCount_Teacher_SchoolLeadership_InclusiveLeadership_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_InclusiveLeadership_Previous), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Previous), Null())';
    let vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Inclusive Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_InclusiveLeadership_Previous), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Previous), Null())';

    // divide by 3 subconstructs
    let vCount_Teacher_SchoolLeadership_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Teacher"}, questionconstruct={"School Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Teacher_SchoolLeadership_Previous = '('&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous) + '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_ExpectationsFeedback_Previous) + '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_InclusiveLeadership_Previous)) / 3';
    let vmmPercMP_Teacher_SchoolLeadership_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_Previous), '&chr(36)&'(vPercMP_Teacher_SchoolLeadership_Previous), Null())';
    let vAvgScore_Teacher_SchoolLeadership_Previous = '('&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ClassroomDecisionMaking_Previous) + '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_ExpectationsFeedback_Previous) + '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_InclusiveLeadership_Previous)) / 3';
    let vmmAvgScore_Teacher_SchoolLeadership_Previous = 'IF('&chr(36)&'(vMinTeachers) <= '&chr(36)&'(vCount_Teacher_SchoolLeadership_Previous), '&chr(36)&'(vAvgScore_Teacher_SchoolLeadership_Previous), Null())';
    
  //// Principal Climate 3 subconstructs (Attendance, External Challenges to Student Learning, School Level Challenges to Student Learning)
    let vCount_Principal_Climate_Attendance_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Attendance_Current), '&chr(36)&'(vPercMP_Principal_Climate_Attendance_Current), Null())';
    let vAvgScore_Principal_Climate_Attendance_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_Attendance_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Attendance_Current), '&chr(36)&'(vAvgScore_Principal_Climate_Attendance_Current), Null())';

    let vCount_Principal_Climate_ExternalChallenges_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_ExternalChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_ExternalChallenges_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_ExternalChallenges_Current), '&chr(36)&'(vPercMP_Principal_Climate_ExternalChallenges_Current), Null())';
    let vAvgScore_Principal_Climate_ExternalChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_ExternalChallenges_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_ExternalChallenges_Current), '&chr(36)&'(vAvgScore_Principal_Climate_ExternalChallenges_Current), Null())';

    let vCount_Principal_Climate_SchoolChallenges_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_SchoolChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_SchoolChallenges_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_SchoolChallenges_Current), '&chr(36)&'(vPercMP_Principal_Climate_SchoolChallenges_Current), Null())';
    let vAvgScore_Principal_Climate_SchoolChallenges_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_SchoolChallenges_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_SchoolChallenges_Current), '&chr(36)&'(vAvgScore_Principal_Climate_SchoolChallenges_Current), Null())';

    // divide by 3 subconstructs 
    let vCount_Principal_Climate_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_Current = '('&chr(36)&'(vPercMP_Principal_Climate_Attendance_Current) + '&chr(36)&'(vPercMP_Principal_Climate_ExternalChallenges_Current) + '&chr(36)&'(vPercMP_Principal_Climate_SchoolChallenges_Current)) / 3';
    let vmmPercMP_Principal_Climate_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Current), '&chr(36)&'(vPercMP_Principal_Climate_Current), Null())';
    let vAvgScore_Principal_Climate_Current = '('&chr(36)&'(vAvgScore_Principal_Climate_Attendance_Current) '&chr(36)&'(vAvgScore_Principal_Climate_ExternalChallenges_Current) + '&chr(36)&'(vAvgScore_Principal_Climate_SchoolChallenges_Current)) / 3';
    let vmmAvgScore_Principal_Climate_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Current), '&chr(36)&'(vAvgScore_Principal_Climate_Current), Null())';
    
    // previous year
    let vCount_Principal_Climate_Attendance_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Attendance_Previous), '&chr(36)&'(vPercMP_Principal_Climate_Attendance_Previous), Null())';
    let vAvgScore_Principal_Climate_Attendance_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"Attendance"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_Attendance_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Attendance_Previous), '&chr(36)&'(vAvgScore_Principal_Climate_Attendance_Previous), Null())';

    let vCount_Principal_Climate_ExternalChallenges_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_ExternalChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_ExternalChallenges_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_ExternalChallenges_Previous), '&chr(36)&'(vPercMP_Principal_Climate_ExternalChallenges_Previous), Null())';
    let vAvgScore_Principal_Climate_ExternalChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"External Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_ExternalChallenges_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_ExternalChallenges_Previous), '&chr(36)&'(vAvgScore_Principal_Climate_ExternalChallenges_Previous), Null())';

    let vCount_Principal_Climate_SchoolChallenges_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_SchoolChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Climate_SchoolChallenges_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_SchoolChallenges_Previous), '&chr(36)&'(vPercMP_Principal_Climate_SchoolChallenges_Previous), Null())';
    let vAvgScore_Principal_Climate_SchoolChallenges_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, subConstructForDisplay={"School Level Challenges to Student Learning"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Climate_SchoolChallenges_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_SchoolChallenges_Previous), '&chr(36)&'(vAvgScore_Principal_Climate_SchoolChallenges_Previous), Null())';

    // divide by 3 subconstructs 
    let vCount_Principal_Climate_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Climate"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Climate_Previous = '('&chr(36)&'(vPercMP_Principal_Climate_Attendance_Previous) + '&chr(36)&'(vPercMP_Principal_Climate_ExternalChallenges_Previous) + '&chr(36)&'(vPercMP_Principal_Climate_SchoolChallenges_Previous)) / 3';
    let vmmPercMP_Principal_Climate_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Previous), '&chr(36)&'(vPercMP_Principal_Climate_Previous), Null())';
    let vAvgScore_Principal_Climate_Previous = '('&chr(36)&'(vAvgScore_Principal_Climate_Attendance_Previous) '&chr(36)&'(vAvgScore_Principal_Climate_ExternalChallenges_Previous) + '&chr(36)&'(vAvgScore_Principal_Climate_SchoolChallenges_Previous)) / 3';
    let vmmAvgScore_Principal_Climate_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Climate_Previous), '&chr(36)&'(vAvgScore_Principal_Climate_Previous), Null())';
  
   //// Principal Instruction 2 subconstructs (Data Use, External Supports)
    let vCount_Principal_Instruction_DataUse_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_DataUse_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Instruction_DataUse_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_DataUse_Current), '&chr(36)&'(vPercMP_Principal_Instruction_DataUse_Current), Null())';
    let vAvgScore_Principal_Instruction_DataUse_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Instruction_DataUse_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_DataUse_Current), '&chr(36)&'(vAvgScore_Principal_Instruction_DataUse_Current), Null())';

    let vCount_Principal_Instruction_ExternalSupports_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_ExternalSupports_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Instruction_ExternalSupports_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_ExternalSupports_Current), '&chr(36)&'(vPercMP_Principal_Instruction_ExternalSupports_Current), Null())';
    let vAvgScore_Principal_Instruction_ExternalSupports_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Instruction_ExternalSupports_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_ExternalSupports_Current), '&chr(36)&'(vAvgScore_Principal_Instruction_ExternalSupports_Current), Null())';

    // divide by 2 subconstructs 
    let vCount_Principal_Instruction_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_Current = '('&chr(36)&'(vPercMP_Principal_Instruction_DataUse_Current) + '&chr(36)&'(vPercMP_Principal_Instruction_ExternalSupports_Current)) / 2';
    let vmmPercMP_Principal_Instruction_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_Current), '&chr(36)&'(vPercMP_Principal_Instruction_Current), Null())';
    let vAvgScore_Principal_Instruction_Current = '('&chr(36)&'(vAvgScore_Principal_Instruction_DataUse_Current) + '&chr(36)&'(vAvgScore_Principal_Instruction_ExternalSupports_Current)) / 2';
    let vmmAvgScore_Principal_Instruction_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_Current), '&chr(36)&'(vAvgScore_Principal_Instruction_Current), Null())';

    // previous year
    let vCount_Principal_Instruction_DataUse_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_DataUse_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Instruction_DataUse_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_DataUse_Previous), '&chr(36)&'(vPercMP_Principal_Instruction_DataUse_Previous), Null())';
    let vAvgScore_Principal_Instruction_DataUse_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"Data Use"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Instruction_DataUse_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_DataUse_Previous), '&chr(36)&'(vAvgScore_Principal_Instruction_DataUse_Previous), Null())';

    let vCount_Principal_Instruction_ExternalSupports_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_ExternalSupports_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_Instruction_ExternalSupports_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_ExternalSupports_Previous), '&chr(36)&'(vPercMP_Principal_Instruction_ExternalSupports_Previous), Null())';
    let vAvgScore_Principal_Instruction_ExternalSupports_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, subConstructForDisplay={"External Supports"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_Instruction_ExternalSupports_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_ExternalSupports_Previous), '&chr(36)&'(vAvgScore_Principal_Instruction_ExternalSupports_Previous), Null())';

    // divide by 2 subconstructs 
    let vCount_Principal_Instruction_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Instruction"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_Instruction_Previous = '('&chr(36)&'(vPercMP_Principal_Instruction_DataUse_Previous) + '&chr(36)&'(vPercMP_Principal_Instruction_ExternalSupports_Previous)) / 2';
    let vmmPercMP_Principal_Instruction_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_Previous), '&chr(36)&'(vPercMP_Principal_Instruction_Previous), Null())';
    let vAvgScore_Principal_Instruction_Previous = '('&chr(36)&'(vAvgScore_Principal_Instruction_DataUse_Previous) + '&chr(36)&'(vAvgScore_Principal_Instruction_ExternalSupports_Previous)) / 2';
    let vmmAvgScore_Principal_Instruction_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_Instruction_Previous), '&chr(36)&'(vAvgScore_Principal_Instruction_Previous), Null())';

  //// Principal Parent/Guardian-Community Ties 0 subconstructs 
    let vCount_Principal_CommunityTies_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_CommunityTies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_CommunityTies_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_CommunityTies_Current), '&chr(36)&'(vPercMP_Principal_CommunityTies_Current), Null())';
    let vAvgScore_Principal_CommunityTies_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_CommunityTies_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_CommunityTies_Current), '&chr(36)&'(vAvgScore_Principal_CommunityTies_Current), Null())';

    // previous year
    let vCount_Principal_CommunityTies_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_CommunityTies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_CommunityTies_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_CommunityTies_Previous), '&chr(36)&'(vPercMP_Principal_CommunityTies_Previous), Null())';
    let vAvgScore_Principal_CommunityTies_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Parent/Guardian-Community Ties"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_CommunityTies_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_CommunityTies_Previous), '&chr(36)&'(vAvgScore_Principal_CommunityTies_Previous), Null())';

  //// Principal Professional Capacity 1 subconstruct (Peer Collaboration)
    let vCount_Principal_ProfessionalCapacity_PeerCollaboration_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_PeerCollaboration_Current), '&chr(36)&'(vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Current), Null())';
    let vAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_PeerCollaboration_Current), '&chr(36)&'(vAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Current), Null())';

    // divide by 1 subconstructs
    let vCount_Principal_ProfessionalCapacity_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_ProfessionalCapacity_Current = chr(36)&'(vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Current)';
    let vmmPercMP_Principal_ProfessionalCapacity_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_Current), '&chr(36)&'(vPercMP_Principal_ProfessionalCapacity_Current), Null())';
    let vAvgScore_Principal_ProfessionalCapacity_Current = chr(36)&'(vavgMP_Principal_ProfessionalCapacity_PeerCollaboration_Current)';
    let vmmAvgScore_Principal_ProfessionalCapacity_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_Current), '&chr(36)&'(vAvgScore_Principal_ProfessionalCapacity_Current), Null())';
    
    // previous year
    let vCount_Principal_ProfessionalCapacity_PeerCollaboration_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_PeerCollaboration_Previous), '&chr(36)&'(vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Previous), Null())';
    let vAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, subConstructForDisplay={"Peer Collaboration"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_PeerCollaboration_Previous), '&chr(36)&'(vAvgScore_Principal_ProfessionalCapacity_PeerCollaboration_Previous), Null())';

    // divide by 1 subconstructs
    let vCount_Principal_ProfessionalCapacity_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"Professional Capacity"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_ProfessionalCapacity_Previous = chr(36)&'(vPercMP_Principal_ProfessionalCapacity_PeerCollaboration_Previous)';
    let vmmPercMP_Principal_ProfessionalCapacity_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_Previous), '&chr(36)&'(vPercMP_Principal_ProfessionalCapacity_Previous), Null())';
    let vAvgScore_Principal_ProfessionalCapacity_Previous = chr(36)&'(vavgMP_Principal_ProfessionalCapacity_PeerCollaboration_Previous)';
    let vmmAvgScore_Principal_ProfessionalCapacity_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_ProfessionalCapacity_Previous), '&chr(36)&'(vAvgScore_Principal_ProfessionalCapacity_Previous), Null())';
    
  //// Principal School Leadership 4 subconstructs (Instructional Leadership, Management: Time spent on, School-level decision making: Control over, School Focus)
    let vCount_Principal_SchoolLeadership_InstructionalLeadership_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_InstructionalLeadership_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_InstructionalLeadership_Current), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Current), Null())';
    let vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_InstructionalLeadership_Current), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Current), Null())';

    let vCount_Principal_SchoolLeadership_ManagementTime_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_ManagementTime_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_ManagementTime_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_ManagementTime_Current), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_ManagementTime_Current), Null())';
    let vAvgScore_Principal_SchoolLeadership_ManagementTime_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_ManagementTime_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_ManagementTime_Current), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_ManagementTime_Current), Null())';

    let vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Current), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Current), Null())';
    let vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Current), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Current), Null())';

    let vCount_Principal_SchoolLeadership_SchoolFocus_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_SchoolFocus_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_SchoolFocus_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolFocus_Current), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolFocus_Current), Null())';
    let vAvgScore_Principal_SchoolLeadership_SchoolFocus_Current = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_SchoolFocus_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolFocus_Current), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolFocus_Current), Null())';

    // divide by 4 subconstructs 
    let vCount_Principal_SchoolLeadership_Current = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vMaxYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_Current = '('&chr(36)&'(vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Current) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_ManagementTime_Current) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Current) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolFocus_Current)) / 4';
    let vmmPercMP_Principal_SchoolLeadership_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_Current), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_Current), Null())';
    let vAvgScore_Principal_SchoolLeadership_Current = '('&chr(36)&'(vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Current) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_ManagementTime_Current) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Current) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolFocus_Current)) / 4';
    let vmmAvgScore_Principal_SchoolLeadership_Current = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_Current), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_Current), Null())';
  
    // previous year
    let vCount_Principal_SchoolLeadership_InstructionalLeadership_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_InstructionalLeadership_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_InstructionalLeadership_Previous), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Previous), Null())';
    let vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Instructional Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_InstructionalLeadership_Previous), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Previous), Null())';

    let vCount_Principal_SchoolLeadership_ManagementTime_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_ManagementTime_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_ManagementTime_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_ManagementTime_Previous), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_ManagementTime_Previous), Null())';
    let vAvgScore_Principal_SchoolLeadership_ManagementTime_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"Management: Time spent on"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_ManagementTime_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_ManagementTime_Previous), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_ManagementTime_Previous), Null())';

    let vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Previous), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Previous), Null())';
    let vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School-level decision making: Control over"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolDecisionMaking_Previous), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Previous), Null())';

    let vCount_Principal_SchoolLeadership_SchoolFocus_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_SchoolFocus_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vmmPercMP_Principal_SchoolLeadership_SchoolFocus_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolFocus_Previous), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolFocus_Previous), Null())';
    let vAvgScore_Principal_SchoolLeadership_SchoolFocus_Previous = 'Avg(Aggr(Avg({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, subConstructForDisplay={"School Focus"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} scaledScore), [School Name], surveyquestnum))';
    let vmmAvgScore_Principal_SchoolLeadership_SchoolFocus_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_SchoolFocus_Previous), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolFocus_Previous), Null())';

    // divide by 4 subconstructs
    let vCount_Principal_SchoolLeadership_Previous = 'Max(Aggr(Count({'&chr(36)&'<surveyTypeForDisplay={"Principal"}, questionconstruct={"School Leadership"}, YearEnd = {'&chr(36)&'(='&chr(36)&'(vLastYearEnd))}>} highest), [School Name], surveyquestnum))';
    let vPercMP_Principal_SchoolLeadership_Previous = '('&chr(36)&'(vPercMP_Principal_SchoolLeadership_InstructionalLeadership_Previous) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_ManagementTime_Previous) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolDecisionMaking_Previous) + '&chr(36)&'(vPercMP_Principal_SchoolLeadership_SchoolFocus_Previous)) / 4';
    let vmmPercMP_Principal_SchoolLeadership_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_Previous), '&chr(36)&'(vPercMP_Principal_SchoolLeadership_Previous), Null())';
    let vAvgScore_Principal_SchoolLeadership_Previous = '('&chr(36)&'(vAvgScore_Principal_SchoolLeadership_InstructionalLeadership_Previous) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_ManagementTime_Previous) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolDecisionMaking_Previous) + '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_SchoolFocus_Previous)) / 4';
    let vmmAvgScore_Principal_SchoolLeadership_Previous = 'IF('&chr(36)&'(vMinPrincipals) <= '&chr(36)&'(vCount_Principal_SchoolLeadership_Previous), '&chr(36)&'(vAvgScore_Principal_SchoolLeadership_Previous), Null())';
    